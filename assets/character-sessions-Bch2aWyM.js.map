{"version":3,"file":"character-sessions-Bch2aWyM.js","sources":["../../../src/views/account/character-sessions.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <div style=\"display: flex; justify-content: space-between; align-items: center;\">\r\n          <span>Character Sessions</span>\r\n          <div class=\"filter-section\">\r\n            <el-form :inline=\"true\">\r\n              <el-form-item label=\"Login Connect Key\">\r\n                <el-input \r\n                  v-model=\"filterParams.connectKey\" \r\n                  placeholder=\"Enter login connect key\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item label=\"Limit\">\r\n                <el-input-number \r\n                  v-model=\"filterParams.count\" \r\n                  :min=\"1\"\r\n                  :max=\"100\"\r\n                  :default-value=\"10\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type=\"primary\" @click=\"handleSearch\">Search</el-button>\r\n                <el-button @click=\"resetFilter\">Reset</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </div>\r\n      </template>\r\n\r\n      <el-table\r\n        v-loading=\"loading\"\r\n        :data=\"sessions\"\r\n        style=\"width: 100%\"\r\n        :max-height=\"'70vh'\"\r\n      >\r\n        <el-table-column\r\n          prop=\"CharacterSessionId\"\r\n          label=\"Session ID\"\r\n          width=\"120\"\r\n        />\r\n        <el-table-column\r\n          prop=\"CharacterId\"\r\n          label=\"Character ID\"\r\n          width=\"120\"\r\n        />\r\n        <el-table-column\r\n          prop=\"CharacterName\"\r\n          label=\"Character Name\"\r\n          width=\"150\"\r\n        />\r\n        <el-table-column\r\n          prop=\"CharacterBattleLevel\"\r\n          label=\"Battle Level\"\r\n          width=\"100\"\r\n        />\r\n        <el-table-column\r\n          prop=\"WinCount\"\r\n          label=\"Wins\"\r\n          width=\"80\"\r\n        />\r\n        <el-table-column\r\n          prop=\"LoseCount\"\r\n          label=\"Loses\"\r\n          width=\"80\"\r\n        />\r\n        <el-table-column\r\n          prop=\"Coins\"\r\n          label=\"Coins\"\r\n          width=\"100\"\r\n        />\r\n        <el-table-column\r\n          prop=\"CharacterSessionStatue\"\r\n          label=\"Status\"\r\n          width=\"120\"\r\n        >\r\n          <template #default=\"{ row }\">\r\n            {{ getStatusText(row.CharacterSessionStatue) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n          prop=\"CreateDate\"\r\n          label=\"Start Date\"\r\n          width=\"180\"\r\n        />\r\n        <el-table-column label=\"Operations\" width=\"120\" fixed=\"right\">\r\n          <template #default=\"{ row }\">\r\n            <el-button type=\"primary\" size=\"small\" @click=\"handleEdit(row)\">\r\n              Edit\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n\r\n    <el-dialog\r\n      title=\"Edit Character Session\"\r\n      v-model=\"dialogVisible\"\r\n      width=\"60%\"\r\n    >\r\n      <el-form v-if=\"currentSession\" :model=\"currentSession\" label-width=\"140px\">\r\n        <el-form-item label=\"Character Name\">\r\n          <el-input v-model=\"currentSession.CharacterName\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"Battle Level\">\r\n          <el-input-number v-model=\"currentSession.CharacterBattleLevel\" :min=\"1\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"Win Count\">\r\n          <el-input-number v-model=\"currentSession.WinCount\" :min=\"0\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"Lose Count\">\r\n          <el-input-number v-model=\"currentSession.LoseCount\" :min=\"0\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"Coins\">\r\n          <el-input-number v-model=\"currentSession.Coins\" :min=\"0\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"Status\">\r\n          <el-select v-model=\"currentSession.CharacterSessionStatue\">\r\n            <el-option label=\"OnGoing\" :value=\"0\" />\r\n            <el-option label=\"Failed\" :value=\"1\" />\r\n            <el-option label=\"ChallengingHoF\" :value=\"2\" />\r\n            <el-option label=\"Finished\" :value=\"3\" />\r\n            <el-option label=\"Quit\" :value=\"99\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <template #footer>\r\n        <el-button @click=\"dialogVisible = false\">Cancel</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSave\">Save</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { queryCharacterSessions, updateCharacterSession } from '@/api/account'\r\nimport type { HWCharacterSession } from '@/shared_models/generated/HWCharacterSession'\r\n\r\ninterface FilterParams {\r\n  connectKey: string\r\n  count: number\r\n}\r\n\r\nconst loading = ref(false)\r\nconst sessions = ref<HWCharacterSession[]>([])\r\nconst dialogVisible = ref(false)\r\nconst currentSession = ref<HWCharacterSession | null>(null)\r\n\r\nconst filterParams = ref<FilterParams>({\r\n  connectKey: '',\r\n  count: 10\r\n})\r\n\r\nconst fetchSessions = async () => {\r\n  loading.value = true\r\n  try {\r\n    const response = await queryCharacterSessions(filterParams.value)\r\n    sessions.value = response.sessions\r\n  } catch (error) {\r\n    console.error('Failed to fetch character sessions:', error)\r\n    ElMessage.error('Failed to fetch sessions')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst handleSearch = () => {\r\n  if (!filterParams.value.connectKey) {\r\n    ElMessage.warning('Please enter a login connect key')\r\n    return\r\n  }\r\n  fetchSessions()\r\n}\r\n\r\nconst resetFilter = () => {\r\n  filterParams.value = {\r\n    connectKey: '',\r\n    count: 10\r\n  }\r\n  sessions.value = []\r\n}\r\n\r\nconst handleEdit = (row: HWCharacterSession) => {\r\n  currentSession.value = { ...row }\r\n  dialogVisible.value = true\r\n}\r\n\r\nconst handleSave = async () => {\r\n  if (!currentSession.value) return\r\n  \r\n  try {\r\n    await updateCharacterSession({\r\n      session: currentSession.value\r\n    })\r\n    ElMessage.success('Session updated successfully')\r\n    dialogVisible.value = false\r\n    fetchSessions()\r\n  } catch (error) {\r\n    console.error('Failed to update session:', error)\r\n    ElMessage.error('Failed to update session')\r\n  }\r\n}\r\n\r\n// Add helper function to convert status enum to text\r\nconst getStatusText = (status: number) => {\r\n  switch (status) {\r\n    case 0: return 'OnGoing'\r\n    case 1: return 'Failed'\r\n    case 2: return 'ChallengingHoF'\r\n    case 3: return 'Finished'\r\n    case 99: return 'Quit'\r\n    default: return 'Unknown'\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.filter-section {\r\n  margin-bottom: 16px;\r\n}\r\n</style> "],"names":["loading","ref","sessions","dialogVisible","currentSession","filterParams","fetchSessions","response","queryCharacterSessions","error","ElMessage","handleSearch","resetFilter","handleEdit","row","handleSave","updateCharacterSession","getStatusText","status"],"mappings":"2bAmJM,MAAAA,EAAUC,EAAI,EAAK,EACnBC,EAAWD,EAA0B,EAAE,EACvCE,EAAgBF,EAAI,EAAK,EACzBG,EAAiBH,EAA+B,IAAI,EAEpDI,EAAeJ,EAAkB,CACrC,WAAY,GACZ,MAAO,EAAA,CACR,EAEKK,EAAgB,SAAY,CAChCN,EAAQ,MAAQ,GACZ,GAAA,CACF,MAAMO,EAAW,MAAMC,EAAuBH,EAAa,KAAK,EAChEH,EAAS,MAAQK,EAAS,eACnBE,EAAO,CACN,QAAA,MAAM,sCAAuCA,CAAK,EAC1DC,EAAU,MAAM,0BAA0B,CAAA,QAC1C,CACAV,EAAQ,MAAQ,EAAA,CAEpB,EAEMW,EAAe,IAAM,CACrB,GAAA,CAACN,EAAa,MAAM,WAAY,CAClCK,EAAU,QAAQ,kCAAkC,EACpD,MAAA,CAEYJ,EAAA,CAChB,EAEMM,EAAc,IAAM,CACxBP,EAAa,MAAQ,CACnB,WAAY,GACZ,MAAO,EACT,EACAH,EAAS,MAAQ,CAAC,CACpB,EAEMW,EAAcC,GAA4B,CAC/BV,EAAA,MAAQ,CAAE,GAAGU,CAAI,EAChCX,EAAc,MAAQ,EACxB,EAEMY,EAAa,SAAY,CACzB,GAACX,EAAe,MAEhB,GAAA,CACF,MAAMY,EAAuB,CAC3B,QAASZ,EAAe,KAAA,CACzB,EACDM,EAAU,QAAQ,8BAA8B,EAChDP,EAAc,MAAQ,GACRG,EAAA,QACPG,EAAO,CACN,QAAA,MAAM,4BAA6BA,CAAK,EAChDC,EAAU,MAAM,0BAA0B,CAAA,CAE9C,EAGMO,EAAiBC,GAAmB,CACxC,OAAQA,EAAQ,CACd,IAAK,GAAU,MAAA,UACf,IAAK,GAAU,MAAA,SACf,IAAK,GAAU,MAAA,iBACf,IAAK,GAAU,MAAA,WACf,IAAK,IAAW,MAAA,OAChB,QAAgB,MAAA,SAAA,CAEpB"}