{"version":3,"file":"index-ku9Pm9ES.js","sources":["../../../src/api/auth.ts","../../../src/views/login/index.vue"],"sourcesContent":["import request from './request'\r\nimport type { LoginRequest, LoginResponse } from '@/types/api'\r\n\r\nexport function email2FALogin(data: LoginRequest) {\r\n  return request<LoginResponse>({\r\n    url: '/admin/AdminAccountManagement/Email2FALogin',\r\n    method: 'post',\r\n    data\r\n  })\r\n} ","<template>\r\n  <div class=\"login-container\">\r\n    <el-form\r\n      ref=\"loginFormRef\"\r\n      :model=\"loginForm\"\r\n      :rules=\"loginRules\"\r\n      class=\"login-form\"\r\n    >\r\n      <h3 class=\"title\">HelloWar Admin</h3>\r\n      <el-form-item prop=\"email\">\r\n        <el-input\r\n          v-model=\"loginForm.email\"\r\n          placeholder=\"Email\"\r\n          type=\"text\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item prop=\"password\">\r\n        <el-input\r\n          v-model=\"loginForm.password\"\r\n          placeholder=\"Password\"\r\n          type=\"password\"\r\n        />\r\n      </el-form-item>\r\n      \r\n      <el-form-item prop=\"code\">\r\n        <el-input\r\n          v-model=\"loginForm.code\"\r\n          placeholder=\"2FA Code\"\r\n          type=\"text\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-button\r\n        :loading=\"loading\"\r\n        type=\"primary\"\r\n        style=\"width: 100%\"\r\n        @click=\"handleLogin\"\r\n      >\r\n        Login\r\n      </el-button>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { email2FALogin } from '@/api/auth'\r\nimport { SHA256 } from 'crypto-js'\r\nimport type { LoginResponse } from '@/types/api'\r\n\r\nconst router = useRouter()\r\nconst loading = ref(false)\r\n\r\nconst loginForm = reactive({\r\n  email: '',\r\n  password: '',\r\n  code: ''\r\n})\r\n\r\nconst loginRules = {\r\n  email: [\r\n    { required: true, message: 'Please input email', trigger: 'blur' },\r\n    { type: 'email', message: 'Please input correct email format', trigger: 'blur' }\r\n  ],\r\n  password: [\r\n    { required: true, message: 'Please input password', trigger: 'blur' }\r\n  ],\r\n  code: [\r\n    { required: true, message: 'Please input 2FA code', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\nconst handleLogin = async () => {\r\n  try {\r\n    loading.value = true\r\n    const hashedPassword = SHA256(loginForm.password).toString()\r\n    const response = (await email2FALogin({\r\n      email: loginForm.email,\r\n      password: hashedPassword,\r\n      code: loginForm.code\r\n    })) as unknown as LoginResponse\r\n    localStorage.setItem('token', response.jwt)\r\n    router.push('/design/HWActionDesign')\r\n  } catch (error) {\r\n    console.error(error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.login-container {\r\n  min-height: 100vh;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  \r\n  .login-form {\r\n    width: 400px;\r\n    padding: 30px;\r\n    border-radius: 6px;\r\n    background: #fff;\r\n    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.1);\r\n    \r\n    .title {\r\n      text-align: center;\r\n      margin-bottom: 30px;\r\n    }\r\n  }\r\n}\r\n</style> "],"names":["email2FALogin","data","request","router","useRouter","loading","ref","loginForm","reactive","loginRules","handleLogin","hashedPassword","SHA256","response","error"],"mappings":"mMAGO,SAASA,EAAcC,EAAoB,CAChD,OAAOC,EAAuB,CAC5B,IAAK,8CACL,OAAQ,OACR,KAAAD,CAAA,CACD,CACH,gEC0CA,MAAME,EAASC,EAAU,EACnBC,EAAUC,EAAI,EAAK,EAEnBC,EAAYC,EAAS,CACzB,MAAO,GACP,SAAU,GACV,KAAM,EAAA,CACP,EAEKC,EAAa,CACjB,MAAO,CACL,CAAE,SAAU,GAAM,QAAS,qBAAsB,QAAS,MAAO,EACjE,CAAE,KAAM,QAAS,QAAS,oCAAqC,QAAS,MAAO,CACjF,EACA,SAAU,CACR,CAAE,SAAU,GAAM,QAAS,wBAAyB,QAAS,MAAO,CACtE,EACA,KAAM,CACJ,CAAE,SAAU,GAAM,QAAS,wBAAyB,QAAS,MAAO,CAAA,CAExE,EAEMC,EAAc,SAAY,CAC1B,GAAA,CACFL,EAAQ,MAAQ,GAChB,MAAMM,EAAiBC,EAAA,OAAOL,EAAU,QAAQ,EAAE,SAAS,EACrDM,EAAY,MAAMb,EAAc,CACpC,MAAOO,EAAU,MACjB,SAAUI,EACV,KAAMJ,EAAU,IAAA,CACjB,EACY,aAAA,QAAQ,QAASM,EAAS,GAAG,EAC1CV,EAAO,KAAK,wBAAwB,QAC7BW,EAAO,CACd,QAAQ,MAAMA,CAAK,CAAA,QACnB,CACAT,EAAQ,MAAQ,EAAA,CAEpB"}