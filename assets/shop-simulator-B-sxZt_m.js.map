{"version":3,"file":"shop-simulator-B-sxZt_m.js","sources":["../../../src/types/api.ts","../../../src/api/analysis.ts","../../../src/views/analysis/shop-simulator.vue"],"sourcesContent":["import { HWBattleCharacterRecord } from \"@/shared_models/generated/HWBattleCharacterRecord\";\r\n\r\nexport enum ErrorType {\r\n  None = 0,\r\n  Others = 99\r\n}\r\n\r\nexport class ApiResponseBase {\r\n  ErrorType: ErrorType = ErrorType.None;\r\n  Error: string = '';\r\n  Message: string = '';\r\n}\r\n\r\nexport class ApiRequestBase {\r\n  \r\n} \r\n\r\nexport class LoginRequest extends ApiRequestBase {\r\n    email: string = '';\r\n    password: string = '';\r\n    code?: string;\r\n}\r\n\r\nexport class LoginResponse extends ApiResponseBase {\r\n    jwt: string = '';\r\n}\r\n\r\nexport class AdminLoadDesignResponse extends ApiResponseBase {\r\n    data: string = '';\r\n}\r\n\r\nexport class QueryTestBattleRecordRequest extends ApiRequestBase {\r\n  wins: number|null = null;\r\n  loses: number|null = null;\r\n  playerId: number|null = null;\r\n  skip: number = 0;\r\n}\r\n\r\n\r\nexport class QueryTestBattleRecordResponse extends ApiResponseBase {\r\n  records: HWBattleCharacterRecord[] = [];\r\n  total: number = 0;\r\n}\r\n\r\n\r\nexport interface DeleteDesignRequest {\r\n    designName: string;\r\n    designId: number;\r\n}\r\n\r\nexport class UpsertTestBattleRecordRequest extends ApiRequestBase\r\n{\r\n    record : HWBattleCharacterRecord = new HWBattleCharacterRecord();\r\n}\r\n\r\nexport class UpsertTestBattleRecordResponse extends ApiResponseBase\r\n{\r\n     record: HWBattleCharacterRecord = new HWBattleCharacterRecord();\r\n}\r\n\r\nexport class AssignRecordToSessionRequest extends ApiRequestBase\r\n{\r\n    recordId : number = 0;\r\n}\r\n\r\nexport class ShopSimulateRequest extends ApiResponseBase\r\n{\r\n  characterDesignId: number = 0;\r\n  battleLevel: number = 0;\r\n  count: number = 999;\r\n}\r\n\r\nexport class ShopSimulateResponse extends ApiRequestBase\r\n{\r\n    byTypeNames: string[] = [];\r\n    byTypeValues: number[] = [];\r\n\r\n    activeActionNames: string[] = [];\r\n    activeActionValues: number[] = [];\r\n\r\n    passiveActionNames: string[] = [];\r\n    passiveActionValues: number[] = [];\r\n    \r\n    eventNames: string[] = [];\r\n    eventValues: number[] = [];\r\n}","import type { ShopSimulateRequest, ShopSimulateResponse } from \"@/types/api\";\r\nimport request from '@/api/request'\r\n\r\n \r\n  export function shopSimulate(params: ShopSimulateRequest) {\r\n    return request<ShopSimulateResponse>({\r\n      url: '/admin/AdminDesignManagement/ShopSimulate',\r\n      method: 'post',\r\n      params,\r\n      data: params\r\n    }) as any as ShopSimulateResponse\r\n  }","<template>\r\n  <div class=\"app-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <div style=\"display: flex; justify-content: space-between; align-items: center;\">\r\n          <span>Shop Simulator</span>\r\n          <div class=\"filter-section\">\r\n            <el-form :inline=\"true\">\r\n              <el-form-item label=\"Character DesignId\">\r\n                <el-input-number \r\n                  v-model=\"filterParams.characterDesignId\" \r\n                  :min=\"0\"\r\n                  placeholder=\"CharacterDesignId\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item label=\"Battle Level\">\r\n                <el-input-number \r\n                  v-model=\"filterParams.battleLevel\" \r\n                  :min=\"0\"\r\n                  placeholder=\"battle level\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item label=\"Simulate Count\">\r\n                <el-input-number \r\n                  v-model=\"filterParams.count\" \r\n                  :min=\"1\"\r\n                  :default-value=\"1000\"\r\n                  placeholder=\"count\"\r\n                />\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type=\"primary\" @click=\"handleSimulate\" :loading=\"loading\">\r\n                  Start\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </div>\r\n      </template>\r\n\r\n      <div class=\"charts-container\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <div class=\"chart-wrapper\">\r\n              <div ref=\"byTypeChartRef\" style=\"width: 100%; height: 400px\"></div>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <div class=\"chart-wrapper\">\r\n              <div ref=\"activeActionChartRef\" style=\"width: 100%; height: 400px\"></div>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"20\" style=\"margin-top: 20px;\">\r\n          <el-col :span=\"12\">\r\n            <div class=\"chart-wrapper\">\r\n              <div ref=\"passiveActionChartRef\" style=\"width: 100%; height: 400px\"></div>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <div class=\"chart-wrapper\">\r\n              <div ref=\"eventChartRef\" style=\"width: 100%; height: 400px\"></div>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, onUnmounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport * as echarts from 'echarts'\r\n\r\nimport { ShopSimulateRequest, ShopSimulateResponse } from '@/types/api'\r\nimport { shopSimulate } from '@/api/analysis'\r\n\r\nconst loading = ref(false)\r\nconst filterParams = ref<ShopSimulateRequest>(new ShopSimulateRequest())\r\n\r\n// 图表引用\r\nconst byTypeChartRef = ref<HTMLElement>()\r\nconst activeActionChartRef = ref<HTMLElement>()\r\nconst passiveActionChartRef = ref<HTMLElement>()\r\nconst eventChartRef = ref<HTMLElement>()\r\n\r\n// 图表实例\r\nlet byTypeChart: echarts.ECharts | null = null\r\nlet activeActionChart: echarts.ECharts | null = null\r\nlet passiveActionChart: echarts.ECharts | null = null\r\nlet eventChart: echarts.ECharts | null = null\r\n\r\n// 初始化图表\r\nconst initCharts = () => {\r\n  if (byTypeChartRef.value) byTypeChart = echarts.init(byTypeChartRef.value)\r\n  if (activeActionChartRef.value) activeActionChart = echarts.init(activeActionChartRef.value)\r\n  if (passiveActionChartRef.value) passiveActionChart = echarts.init(passiveActionChartRef.value)\r\n  if (eventChartRef.value) eventChart = echarts.init(eventChartRef.value)\r\n}\r\n\r\n// 更新图表数据\r\nconst updateCharts = (data: ShopSimulateResponse) => {\r\n  const chartOptions = (title: string, names: string[], values: number[]) => ({\r\n    title: { text: title },\r\n    tooltip: { trigger: 'axis' },\r\n    xAxis: { \r\n      type: 'category',\r\n      data: names,\r\n      axisLabel: { interval: 0, rotate: 45 }\r\n    },\r\n    yAxis: { type: 'value' },\r\n    series: [{\r\n      data: values,\r\n      type: 'bar',\r\n      showBackground: true,\r\n      backgroundStyle: {\r\n        color: 'rgba(180, 180, 180, 0.2)'\r\n      }\r\n    }]\r\n  })\r\n\r\n  byTypeChart?.setOption(chartOptions('By Chip Type', data.byTypeNames, data.byTypeValues))\r\n  activeActionChart?.setOption(chartOptions('Active Action Chips', data.activeActionNames, data.activeActionValues))\r\n  passiveActionChart?.setOption(chartOptions('Passive Action Chips', data.passiveActionNames, data.passiveActionValues))\r\n  eventChart?.setOption(chartOptions('Event Chips', data.eventNames, data.eventValues))\r\n}\r\n\r\n// 处理模拟请求\r\nconst handleSimulate = async () => {\r\n  if (!filterParams.value.count) {\r\n    ElMessage.warning('请输入模拟次数')\r\n    return\r\n  }\r\n\r\n  loading.value = true\r\n  try {\r\n    const response = await shopSimulate(filterParams.value)\r\n    updateCharts(response)\r\n  } catch (error) {\r\n    console.error('模拟失败:', error)\r\n    ElMessage.error('模拟失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 监听窗口大小变化\r\nconst handleResize = () => {\r\n  byTypeChart?.resize()\r\n  activeActionChart?.resize()\r\n  passiveActionChart?.resize()\r\n  eventChart?.resize()\r\n}\r\n\r\nonMounted(() => {\r\n  initCharts()\r\n  window.addEventListener('resize', handleResize)\r\n})\r\n\r\nonUnmounted(() => {\r\n  window.removeEventListener('resize', handleResize)\r\n  byTypeChart?.dispose()\r\n  activeActionChart?.dispose()\r\n  passiveActionChart?.dispose()\r\n  eventChart?.dispose()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.app-container {\r\n  padding: 20px;\r\n}\r\n\r\n.charts-container {\r\n  margin-top: 20px;\r\n}\r\n\r\n.chart-wrapper {\r\n  background: #fff;\r\n  padding: 20px;\r\n  border-radius: 4px;\r\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.filter-section {\r\n  margin-bottom: 16px;\r\n}\r\n</style> "],"names":["ApiResponseBase","__publicField","ShopSimulateRequest","shopSimulate","params","request","loading","ref","filterParams","byTypeChartRef","activeActionChartRef","passiveActionChartRef","eventChartRef","byTypeChart","activeActionChart","passiveActionChart","eventChart","initCharts","echarts.init","updateCharts","data","chartOptions","title","names","values","handleSimulate","ElMessage","response","error","handleResize","onMounted","onUnmounted"],"mappings":"mXAOO,MAAMA,CAAgB,CAAtB,cACLC,EAAA,iBAAuB,GACvBA,EAAA,aAAgB,IAChBA,EAAA,eAAkB,IACpB,CAsDO,MAAMC,UAA4BF,CACzC,CADO,kCAELC,EAAA,yBAA4B,GAC5BA,EAAA,mBAAsB,GACtBA,EAAA,aAAgB,KAClB,CClES,SAASE,EAAaC,EAA6B,CACxD,OAAOC,EAA8B,CACnC,IAAK,4CACL,OAAQ,OACR,OAAAD,EACA,KAAMA,CAAA,CACP,CACH,4TCmEI,MAAAE,EAAUC,EAAI,EAAK,EACnBC,EAAeD,EAAyB,IAAIL,CAAqB,EAGjEO,EAAiBF,EAAiB,EAClCG,EAAuBH,EAAiB,EACxCI,EAAwBJ,EAAiB,EACzCK,EAAgBL,EAAiB,EAGvC,IAAIM,EAAsC,KACtCC,EAA4C,KAC5CC,EAA6C,KAC7CC,EAAqC,KAGzC,MAAMC,EAAa,IAAM,CACnBR,EAAe,QAAOI,EAAcK,EAAaT,EAAe,KAAK,GACrEC,EAAqB,QAAOI,EAAoBI,EAAaR,EAAqB,KAAK,GACvFC,EAAsB,QAAOI,EAAqBG,EAAaP,EAAsB,KAAK,GAC1FC,EAAc,QAAOI,EAAaE,EAAaN,EAAc,KAAK,EACxE,EAGMO,EAAgBC,GAA+B,CACnD,MAAMC,EAAe,CAACC,EAAeC,EAAiBC,KAAsB,CAC1E,MAAO,CAAE,KAAMF,CAAM,EACrB,QAAS,CAAE,QAAS,MAAO,EAC3B,MAAO,CACL,KAAM,WACN,KAAMC,EACN,UAAW,CAAE,SAAU,EAAG,OAAQ,EAAG,CACvC,EACA,MAAO,CAAE,KAAM,OAAQ,EACvB,OAAQ,CAAC,CACP,KAAMC,EACN,KAAM,MACN,eAAgB,GAChB,gBAAiB,CACf,MAAO,0BAAA,CAEV,CAAA,CAAA,GAGHX,GAAA,MAAAA,EAAa,UAAUQ,EAAa,eAAgBD,EAAK,YAAaA,EAAK,YAAY,GACvFN,GAAA,MAAAA,EAAmB,UAAUO,EAAa,sBAAuBD,EAAK,kBAAmBA,EAAK,kBAAkB,GAChHL,GAAA,MAAAA,EAAoB,UAAUM,EAAa,uBAAwBD,EAAK,mBAAoBA,EAAK,mBAAmB,GACpHJ,GAAA,MAAAA,EAAY,UAAUK,EAAa,cAAeD,EAAK,WAAYA,EAAK,WAAW,EACrF,EAGMK,EAAiB,SAAY,CAC7B,GAAA,CAACjB,EAAa,MAAM,MAAO,CAC7BkB,EAAU,QAAQ,SAAS,EAC3B,MAAA,CAGFpB,EAAQ,MAAQ,GACZ,GAAA,CACF,MAAMqB,EAAW,MAAMxB,EAAaK,EAAa,KAAK,EACtDW,EAAaQ,CAAQ,QACdC,EAAO,CACN,QAAA,MAAM,QAASA,CAAK,EAC5BF,EAAU,MAAM,MAAM,CAAA,QACtB,CACApB,EAAQ,MAAQ,EAAA,CAEpB,EAGMuB,EAAe,IAAM,CACzBhB,GAAA,MAAAA,EAAa,SACbC,GAAA,MAAAA,EAAmB,SACnBC,GAAA,MAAAA,EAAoB,SACpBC,GAAA,MAAAA,EAAY,QACd,EAEA,OAAAc,EAAU,IAAM,CACHb,EAAA,EACJ,OAAA,iBAAiB,SAAUY,CAAY,CAAA,CAC/C,EAEDE,EAAY,IAAM,CACT,OAAA,oBAAoB,SAAUF,CAAY,EACjDhB,GAAA,MAAAA,EAAa,UACbC,GAAA,MAAAA,EAAmB,UACnBC,GAAA,MAAAA,EAAoB,UACpBC,GAAA,MAAAA,EAAY,SAAQ,CACrB"}