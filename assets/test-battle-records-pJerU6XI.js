import{d as W,v as u,a as z,B as K,b as Y,f as l,w as t,r as d,D as H,o as B,e as C,j as p,C as Q,c as A,L as X,t as Z,K as ee,G as le,E as _}from"./vendor-B-767y0k.js";import{a as ae,u as te,q as oe}from"./account-DnEBmT1n.js";import{_ as ne}from"./index-A75kaW5P.js";import"./request-C0hLSC6d.js";const re={class:"app-container"},se={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ue={class:"filter-section"},de={class:"column-header"},ie={class:"pagination-container"},pe=W({__name:"test-battle-records",setup(me){const I=u({}),y=u(!1),x=u(""),h=u(!1),S=u([]),v=u(1),b=u(50),g=u(!1),n=u(null),k=u(0),m=u({wins:null,loses:null,playerId:null,skip:0}),V=async()=>{h.value=!0;try{const o={...m.value,skip:(v.value-1)*b.value},e=await oe(o);S.value=e.records,k.value=e.total}catch(o){console.error("获取测试战斗记录失败:",o),_.error("获取记录失败")}finally{h.value=!1}},N=()=>{v.value=1,V()},G=()=>{m.value={wins:null,loses:null,playerId:null,skip:0},v.value=1,V()},R=o=>{n.value={...o},g.value=!0},E=o=>{y.value=!0,x.value=o.AIGraphJson},L=o=>{le.confirm("Are you sure to assign this record to system session?","Warning",{confirmButtonText:"Yes",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{await ae({recordId:o.BattleCharacterRecordId})}catch(e){console.error(e),_.error("Assign failed")}})},T=()=>{},J=async()=>{if(n.value)try{const o={record:n.value};await te(o),_.success("保存成功"),g.value=!1,V()}catch(o){console.error("保存失败:",o),_.error("保存失败")}};z(()=>{let o=[...S.value];return Object.entries(I.value).forEach(([e,c])=>{c&&(o=o.filter(s=>{const r=s[e];return typeof r=="number"?r.toString().includes(c):typeof r=="string"?r.toLowerCase().includes(c.toLowerCase()):!1}))}),o});const $=z(()=>S.value),j=o=>{b.value=o,v.value=1,V()},q=o=>{v.value=o,V()};return K(()=>{}),(o,e)=>{const c=d("el-input-number"),s=d("el-form-item"),r=d("el-button"),U=d("el-form"),i=d("el-table-column"),f=d("el-input"),M=d("el-table"),F=d("el-pagination"),P=d("el-card"),D=d("el-dialog"),O=H("loading");return B(),Y("div",re,[l(P,null,{header:t(()=>[C("div",se,[e[19]||(e[19]=C("span",null,"测试战斗记录",-1)),C("div",ue,[l(U,{inline:!0},{default:t(()=>[l(s,{label:"胜场"},{default:t(()=>[l(c,{modelValue:m.value.wins,"onUpdate:modelValue":e[0]||(e[0]=a=>m.value.wins=a),min:0,placeholder:"胜场数"},null,8,["modelValue"])]),_:1}),l(s,{label:"负场"},{default:t(()=>[l(c,{modelValue:m.value.loses,"onUpdate:modelValue":e[1]||(e[1]=a=>m.value.loses=a),min:0,placeholder:"负场数"},null,8,["modelValue"])]),_:1}),l(s,{label:"玩家ID"},{default:t(()=>[l(c,{modelValue:m.value.playerId,"onUpdate:modelValue":e[2]||(e[2]=a=>m.value.playerId=a),min:0,placeholder:"玩家ID"},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[l(r,{type:"primary",onClick:N},{default:t(()=>e[17]||(e[17]=[p("搜索")])),_:1}),l(r,{onClick:G},{default:t(()=>e[18]||(e[18]=[p("重置")])),_:1})]),_:1})]),_:1})])])]),default:t(()=>[Q((B(),A(M,{data:$.value,style:{width:"100%"},"max-height":"70vh"},{default:t(()=>[l(i,{prop:"BattleCharacterRecordId",label:"ID",width:"80"}),l(i,{prop:"CharacterDesignId",label:"CharacterDesign",width:"150"}),l(i,{prop:"CharacterName",label:"Name",width:"150"},{header:t(({column:a})=>[C("div",de,[e[20]||(e[20]=C("div",{class:"header-title"}," CharacterName ",-1)),l(f,{modelValue:I.value.CharacterName,"onUpdate:modelValue":e[3]||(e[3]=w=>I.value.CharacterName=w),size:"small",placeholder:"Search",onInput:T,onClick:e[4]||(e[4]=X(()=>{},["stop"]))},null,8,["modelValue"])])]),_:1}),l(i,{prop:"Score",label:"Score(WinCount)",width:"180"}),l(i,{prop:"CharacterBattleLevel",label:"BattleLevel",width:"180"}),l(i,{prop:"SessionBattleIndex",label:"BattleIndex",width:"180"}),l(i,{label:"AIGraph",width:"150"},{default:t(({row:a})=>[l(r,{type:"primary",size:"small",onClick:w=>E(a)},{default:t(()=>e[21]||(e[21]=[p(" Show ")])),_:2},1032,["onClick"])]),_:1}),l(i,{label:"Operations",width:"150",fixed:"right"},{default:t(({row:a})=>[l(r,{type:"primary",size:"small",onClick:w=>R(a)},{default:t(()=>e[22]||(e[22]=[p(" Edit ")])),_:2},1032,["onClick"])]),_:1}),l(i,{label:"Assign To Session",width:"150",fixed:"right"},{default:t(({row:a})=>[l(r,{type:"primary",size:"small",onClick:w=>L(a)},{default:t(()=>e[23]||(e[23]=[p(" Assign ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,h.value]]),C("div",ie,[l(F,{"current-page":v.value,"onUpdate:currentPage":e[5]||(e[5]=a=>v.value=a),"page-size":b.value,"onUpdate:pageSize":e[6]||(e[6]=a=>b.value=a),total:k.value,"page-sizes":[50],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:j,onCurrentChange:q},null,8,["current-page","page-size","total"])])]),_:1}),l(D,{title:"AI Graph Json",modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=a=>y.value=a),width:"60vw"},{footer:t(()=>[l(r,{onClick:e[7]||(e[7]=a=>y.value=!1)},{default:t(()=>e[24]||(e[24]=[p("Cancel")])),_:1})]),default:t(()=>[p(Z(x.value)+" ",1)]),_:1},8,["modelValue"]),l(D,{title:"Edit Record",modelValue:g.value,"onUpdate:modelValue":e[16]||(e[16]=a=>g.value=a),width:"60%"},{footer:t(()=>[l(r,{onClick:e[15]||(e[15]=a=>g.value=!1)},{default:t(()=>e[25]||(e[25]=[p("Cancel")])),_:1}),l(r,{type:"primary",onClick:J},{default:t(()=>e[26]||(e[26]=[p("Save")])),_:1})]),default:t(()=>[n.value?(B(),A(U,{key:0,model:n.value,"label-width":"140px"},{default:t(()=>[l(s,{label:"CharacterName"},{default:t(()=>[l(f,{modelValue:n.value.CharacterName,"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.CharacterName=a)},null,8,["modelValue"])]),_:1}),l(s,{label:"CharacterDesignId"},{default:t(()=>[l(f,{modelValue:n.value.CharacterDesignId,"onUpdate:modelValue":e[10]||(e[10]=a=>n.value.CharacterDesignId=a),type:"number"},null,8,["modelValue"])]),_:1}),l(s,{label:"Score"},{default:t(()=>[l(f,{modelValue:n.value.Score,"onUpdate:modelValue":e[11]||(e[11]=a=>n.value.Score=a),type:"number"},null,8,["modelValue"])]),_:1}),l(s,{label:"CharacterBattleLevel"},{default:t(()=>[l(f,{modelValue:n.value.CharacterBattleLevel,"onUpdate:modelValue":e[12]||(e[12]=a=>n.value.CharacterBattleLevel=a),type:"number"},null,8,["modelValue"])]),_:1}),l(s,{label:"SessionBattleIndex"},{default:t(()=>[l(f,{modelValue:n.value.SessionBattleIndex,"onUpdate:modelValue":e[13]||(e[13]=a=>n.value.SessionBattleIndex=a),type:"number"},null,8,["modelValue"])]),_:1}),l(s,{label:"AIGraphJson"},{default:t(()=>[l(f,{modelValue:n.value.AIGraphJson,"onUpdate:modelValue":e[14]||(e[14]=a=>n.value.AIGraphJson=a),type:"textarea",rows:4},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):ee("",!0)]),_:1},8,["modelValue"])])}}}),ge=ne(pe,[["__scopeId","data-v-2fa166dc"]]);export{ge as default};
//# sourceMappingURL=test-battle-records-pJerU6XI.js.map
